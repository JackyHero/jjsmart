/*!
 * jSmart JavaScript template engine (v3.0.0)
 * https://github.com/umakantp/jsmart
 * https://opensource.org/licenses/MIT
 *
 * Copyright 2011-2017, Umakant Patil <me at umakantpatil dot com>
 *                      Max Miroshnikov <miroshnikov at gmail dot com>
 */

!function(e){"use strict";"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=e():(window&&window.document&&(window.jSmart=e()),"function"==typeof define&&define.amd&&define("jSmart",[],e))}(function(){"use strict";function e(e,t){for(var r=1;r<arguments.length;++r)for(var s in arguments[r])e[s]=arguments[r][s];return e}function t(e){return e.replace(/\\t/,"\t").replace(/\\n/,"\n").replace(/\\(['"\\])/g,"$1")}function r(e){return t(e.replace(/^['"](.*)['"]$/,"$1")).replace(/^\s+|\s+$/g,"")}function s(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}function a(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function i(e){var t=0;for(var r in e)e.hasOwnProperty(r)&&t++;return t}var n={files:{},ldelim:"{",rdelim:"}",autoLiteral:!0,runTimePlugins:{},plugins:{},preFilters:[],getTemplate:function(e){throw new Error("no getTemplate function defined.")},clear:function(){this.runTimePlugins={},this.preFilters=[],this.autoLiteral=!0,this.plugins={},this.ldelim="{",this.rdelim="}"},getParsed:function(e){var t,r=[];return e=this.removeComments(e),e=e.replace(/\r\n/g,"\n"),e=this.applyFilters(this.preFilters,e),r=this.parse(e),t=this.runTimePlugins,this.clear(),{tree:r,runTimePlugins:t}},parse:function(e){var t,r,s,a,i,n,p=[];for(t=this.findTag("",e);t;t=this.findTag("",e))if(t.index&&(p=p.concat(this.parseText(e.slice(0,t.index)))),e=e.slice(t.index+t[0].length),r=t[1].match(/^\s*(\w+)(.*)$/))if(s=r[1],a=r.length>2?r[2].replace(/^\s+|\s+$/g,""):"",s in this.buildInFunctions){var o=this.buildInFunctions[s],l=("parseParams"in o?o.parseParams.bind(this):this.parseParams.bind(this))(a);if("block"===o.type){e=e.replace(/^\n/,""),n=this.findCloseTag("/"+s,s+" +[^}]*",e);var u=o.parse.call(this,l,e.slice(0,n.index));u&&(p=p.concat(u)),e=e.slice(n.index+n[0].length)}else"extends"===s&&p.splice(0,p.length),p=p.concat(o.parse.call(this,l));e=e.replace(/^\n/,"")}else if(s in this.runTimePlugins)p=p.concat(this.parsePluginFunc(s,this.parseParams(a)));else if(s in this.plugins){var c=this.plugins[s];"block"===c.type?(n=this.findCloseTag("/"+s,s+" +[^}]*",e),p=p.concat(this.parsePluginBlock(s,this.parseParams(a),e.slice(0,n.index))),e=e.slice(n.index+n[0].length)):"function"===c.type&&(p=p.concat(this.parsePluginFunc(s,this.parseParams(a)))),"append"!==s&&"assign"!==s&&"capture"!==s&&"eval"!==s&&"include"!==s||(e=e.replace(/^\n/,""))}else i=this.buildInFunctions.expression.parse.call(this,t[1]),p.push(i);else"build-in"===(i=this.buildInFunctions.expression.parse.call(this,t[1])).expression.type&&"operator"===i.expression.name&&"="===i.expression.op&&(e=e.replace(/^\n/,"")),p.push(i);return e&&(p=p.concat(this.parseText(e))),p},findTag:function(e,t){var r,s,a,i=0,n=0,p=this.ldelim,o=this.rdelim,l=this.autoLiteral,u=/^\s*(.+)\s*$/i,c=e?new RegExp("^\\s*("+e+")\\s*$","i"):u;for(r=0;r<t.length;++r)if(t.substr(r,p.length)===p){if(l&&r+1<t.length&&t.substr(r+1,1).match(/\s/))continue;i||(t=t.slice(r),n+=parseInt(r),r=0),++i}else if(t.substr(r,o.length)===o){if(l&&r-1>=0&&t.substr(r-1,1).match(/\s/))continue;if(!--i&&(s=t.slice(p.length,r).replace(/[\r\n]/g," "),a=s.match(c)))return a.index=n,a[0]=t.slice(0,r+o.length),a;i<0&&(i=0)}return null},findElseTag:function(e,t,r,s){for(var a=0,i=this.findTag(r,s);i;i=this.findTag(r,s)){var n=this.findTag(e,s);if(!n||n.index>i.index)return i.index+=a,i;s=s.slice(n.index+n[0].length),a+=n.index+n[0].length;var p=this.findCloseTag(t,e,s);s=s.slice(p.index+p[0].length),a+=p.index+p[0].length}return null},findCloseTag:function(e,t,r){var s="",a=null,i=null,n=0;do{if(a&&(n+=a[0].length),!(a=this.findTag(e,r)))throw new Error("Unclosed "+this.ldelim+t+this.rdelim);s+=r.slice(0,a.index),n+=a.index,r=r.slice(a.index+a[0].length),(i=this.findTag(t,s))&&(s=s.slice(i.index+i[0].length))}while(i);return a.index=n,a},bundleOp:function(e,t,r){var s=t[e];if("operator"===s.name&&s.precedence===r&&!s.params.__parsed){if("binary"===s.optype)return s.params.__parsed=[t[e-1],t[e+1]],t.splice(e-1,3,s),[!0,t];if("post-unary"===s.optype)return s.params.__parsed=[t[e-1]],t.splice(e-1,2,s),[!0,t];s.params.__parsed=[t[e+1]],t.splice(e,2,s)}return[!1,t]},composeExpression:function(e){var t,r=0;for(r=0;r<e.length;++r)e[r]instanceof Array&&(e[r]=this.composeExpression(e[r]));for(var s=1;s<14;++s)if(2===s||10===s)for(r=e.length;r>0;--r)r-=(t=this.bundleOp(r-1,e,s))[0],e=t[1];else for(r=0;r<e.length;++r)r-=(t=this.bundleOp(r,e,s))[0],e=t[1];return e[0]},getMatchingToken:function(e){for(var t=0;t<this.tokens.length;++t)if(e.match(this.tokens[t].regex))return t;return!1},parseVar:function(e,t,r){var s,a,i=/^(?:\.|\s*->\s*|\[\s*)/,n={value:"",tree:[]},p="",o=[{type:"text",data:t.replace(/^(\w+)@(key|index|iteration|first|last|show|total)/gi,"$1__$2")}],l=r;for(r||(l=r=t),s=e.match(i);s;s=e.match(i)){if(r+=s[0],e=e.slice(s[0].length),s[0].match(/\[/)){(n=this.parseExpression(e,!0)).tree&&(r+=n.value,o.push(n.tree),e=e.slice(n.value.length));var u=e.match(/\s*\]/);u&&(r+=u[0],e=e.slice(u[0].length))}else{var c=this.parseModifiersStop;if(this.parseModifiersStop=!0,a=this.lookUp(e,""))if(n.tree=[].concat(n.tree,a.tree),n.value=a.value,r+=a.value,a.ret){var h=n.tree[n.tree.length-1];"plugin"===h.type&&"__func"===h.name&&(h.hasOwner=!0),o.push(h),e=e.slice(n.value.length)}else n=!1;this.parseModifiersStop=c}n||o.push({type:"text",data:""})}return p=r.substr(l.length),{s:e,token:r,tree:[{type:"var",parts:o}],value:p}},parseFunc:function(e,t,r){return t.__parsed.name=this.parseText(e,[])[0],r.push({type:"plugin",name:"__func",params:t}),r},parseOperator:function(e,t,r){return[{type:"build-in",name:"operator",op:e,optype:t,precedence:r,params:{}}]},parsePluginBlock:function(e,t,r){return[{type:"plugin",name:e,params:t,subTree:this.parse(r,[])}]},parsePluginFunc:function(e,t){return[{type:"plugin",name:e,params:t}]},parseModifiers:function(e,t){var r,s=e.match(/^\|(\w+)/),a="";if(!this.parseModifiersStop&&s){a+=s[0],r="default"===s[1]?"defaultValue":s[1],e=e.slice(s[0].length).replace(/^\s+/,""),this.parseModifiersStop=!0;for(var i=[],n=e.match(/^\s*:\s*/);n;n=e.match(/^\s*:\s*/)){a+=e.slice(0,n[0].length),e=e.slice(n[0].length);var p=this.lookUp(e,"");p.ret?(a+=p.value,i.push(p.tree[0]),e=e.slice(p.value.length)):i.push(this.parseText(""))}this.parseModifiersStop=!1,i.unshift(t.pop());var o=this.parseFunc(r,{__parsed:i},[]);t.push(o[0]);var l=this.parseModifiers(e,t);return l&&(t=t.concat(l.tree)),{value:a,tree:t}}},parseParams:function(e,t,s){var a=e.replace(/\n/g," ").replace(/^\s+|\s+$/g,""),i=[];if(e="",i.__parsed=[],!a)return i;for(t||(t=/^\s+/,s=/^(\w+)\s*=\s*/);a;){var n=null;if(s){var p=a.match(s);if(p){var o=p[1].charAt(0).match(/^\d+/);"true"!==p[1]&&"false"!==p[1]&&"null"!==p[1]||(o=!0),o||(n=r(p[1]),e+=a.slice(0,p[0].length),a=a.slice(p[0].length))}}var l=this.parseExpression(a);if(!l)break;n?(i[n]=l.value,i.__parsed[n]=l.tree):(i.push(l.value),i.__parsed.push(l.tree)),e+=a.slice(0,l.value.length);var u=(a=a.slice(l.value.length)).match(t);if(!u)break;e+=a.slice(0,u[0].length),a=a.slice(u[0].length)}return i.toString=function(){return e},i},lookUp:function(e,t){var r,s=[];if(!e)return!1;if(e.substr(0,this.ldelim.length)===this.ldelim&&(r=this.findTag("",e),t+=r[0],r)){var a=this.parse(r[0]);s=s.concat(a);var i=this.parseModifiers(e.slice(t.length),s);return i?{ret:!0,tree:i.tree,value:i.value}:{ret:!0,tree:s,value:t}}var n=this.getMatchingToken(e);if(!1!==n){t+=RegExp.lastMatch;var p=this.tokens[n].parse.call(this,e.slice(RegExp.lastMatch.length),{tree:s,token:RegExp.lastMatch});if("string"==typeof p)if("parenStart"===p){var o=[];s.push(o),o.parent=s,s=o}else"parenEnd"===p&&s.parent&&(s=s.parent);else p&&p.constructor===Object?(t+=p.value,p=p.tree,s=s.concat(p)):s=s.concat(p);return{ret:!0,tree:s,value:t}}return{ret:!1,tree:s,value:t}},parseExpression:function(e){var t,r=[],s="";for(this.lastTreeInExpression=r;;){if(!(t=this.lookUp(e.slice(s.length),s)))break;if(r=r.concat(t.tree),s=t.value,this.lastTreeInExpression=r,!t.ret)break}return r.length&&(r=this.composeExpression(r)),{tree:r,value:s}},parseBool:function(e){return[{type:"boolean",data:e}]},parseText:function(e){var t=[];if(this.parseEmbeddedVars)for(var r=/([$][\w@]+)|`([^`]*)`/,s=r.exec(e);s;s=r.exec(e)){t.push({type:"text",data:e.slice(0,s.index)});var a=this.parseExpression(s[1]?s[1]:s[2]);t.push(a.tree),e=e.slice(s.index+s[0].length)}return t.push({type:"text",data:e}),t},loadTemplate:function(e,t){var r=[];if(!t&&e in this.files)r=this.files[e];else{var s=this.getTemplate(e);if("string"!=typeof s)throw new Error("No template for "+e);s=this.removeComments(s.replace(/\r\n/g,"\n")),s=this.applyFilters(this.preFilters,s),r=this.parse(s),this.files[e]=r}return r},removeComments:function(e){for(var t=new RegExp(this.ldelim+"\\*"),r=new RegExp("\\*"+this.rdelim),s="",a=e.match(t);a;a=e.match(r)){s+=e.slice(0,a.index);var i=(e=e.slice(a.index+a[0].length)).match(r);if(!i)throw new Error("Unclosed "+t+"*");e=e.slice(i.index+i[0].length)}return s+e},applyFilters:function(e,t){for(var r=0;r<e.length;++r)t=e[r](t);return t},tokens:[{regex:/^\$([\w@]+)/,parse:function(e,t){var r=this.parseVar(e,RegExp.$1,RegExp.$1),s=this.parseModifiers(r.s,r.tree);return s?(r.value+=s.value,s):r}},{regex:/^(true|false)/i,parse:function(e,t){return t.token.match(/true/i)?this.parseBool(!0):this.parseBool(!1)}},{regex:/^'([^'\\]*(?:\\.[^'\\]*)*)'/,parse:function(e,r){var s=t(RegExp.$1),a=this.parseText(s),i=this.parseModifiers(e,a);return i||a}},{regex:/^"([^"\\]*(?:\\.[^"\\]*)*)"/,parse:function(e,r){var s=t(RegExp.$1),a=s.match(this.tokens[0].regex);if(a){var i=this.parseVar(s,a[1],a[0]);if(i.token.length===s.length)return[i.tree[0]]}this.parseEmbeddedVars=!0;var n=[];n.push({type:"plugin",name:"__quoted",params:{__parsed:this.parse(s,[])}}),this.parseEmbeddedVars=!1;var p=this.parseModifiers(e,n);return p||n}},{regex:/^(\w+)\s*[(]([)]?)/,parse:function(e,t){var r=RegExp.$1,s=RegExp.$2,a=this.parseParams(s?"":e,/^\s*,\s*/),i=this.parseFunc(r,a,[]),n=this.parseModifiers(e.slice(a.toString().length),i);return n||i}},{regex:/^\s*\(\s*/,parse:function(e,t){return"parenStart"}},{regex:/^\s*\)\s*/,parse:function(e,t){return"parenEnd"}},{regex:/^\s*(\+\+|--)\s*/,parse:function(e,t){return this.lastTreeInExpression.length&&"var"===this.lastTreeInExpression[this.lastTreeInExpression.length-1].type?this.parseOperator(RegExp.$1,"post-unary",1):this.parseOperator(RegExp.$1,"pre-unary",1)}},{regex:/^\s*(===|!==|==|!=)\s*/,parse:function(e,t){return this.parseOperator(RegExp.$1,"binary",6)}},{regex:/^\s+(eq|ne|neq)\s+/i,parse:function(e,t){var r=RegExp.$1.replace(/ne(q)?/,"!=").replace(/eq/,"==");return this.parseOperator(r,"binary",6)}},{regex:/^\s*!\s*/,parse:function(e,t){return this.parseOperator("!","pre-unary",2)}},{regex:/^\s+not\s+/i,parse:function(e,t){return this.parseOperator("!","pre-unary",2)}},{regex:/^\s*(=|\+=|-=|\*=|\/=|%=)\s*/,parse:function(e,t){return this.parseOperator(RegExp.$1,"binary",10)}},{regex:/^\s*(\*|\/|%)\s*/,parse:function(e,t){return this.parseOperator(RegExp.$1,"binary",3)}},{regex:/^\s+mod\s+/i,parse:function(e,t){return this.parseOperator("%","binary",3)}},{regex:/^\s*(\+|-)\s*/,parse:function(e,t){return this.lastTreeInExpression.length&&"operator"!==this.lastTreeInExpression[this.lastTreeInExpression.length-1].name?this.parseOperator(RegExp.$1,"binary",4):this.parseOperator(RegExp.$1,"pre-unary",4)}},{regex:/^\s*(<=|>=|<>|<|>)\s*/,parse:function(e,t){return this.parseOperator(RegExp.$1.replace(/<>/,"!="),"binary",5)}},{regex:/^\s+(lt|lte|le|gt|gte|ge)\s+/i,parse:function(e,t){var r=RegExp.$1.replace(/l(t)?e/,"<").replace(/lt/,"<=").replace(/g(t)?e/,">").replace(/gt/,">=");return this.parseOperator(r,"binary",5)}},{regex:/^\s+(is\s+(not\s+)?div\s+by)\s+/i,parse:function(e,t){return this.parseOperator(RegExp.$2?"div_not":"div","binary",7)}},{regex:/^\s+is\s+(not\s+)?(even|odd)(\s+by\s+)?\s*/i,parse:function(e,t){var r=RegExp.$1?"odd"===RegExp.$2?"even":"even_not":"odd"===RegExp.$2?"even_not":"even",s=this.parseOperator(r,"binary",7);return RegExp.$3?s:s.concat(this.parseText("1",s))}},{regex:/^\s*(&&)\s*/,parse:function(e,t){return this.parseOperator(RegExp.$1,"binary",8)}},{regex:/^\s*(\|\|)\s*/,parse:function(e,t){return this.parseOperator(RegExp.$1,"binary",9)}},{regex:/^\s+and\s+/i,parse:function(e,t){return this.parseOperator("&&","binary",11)}},{regex:/^\s+xor\s+/i,parse:function(e,t){return this.parseOperator("xor","binary",12)}},{regex:/^\s+or\s+/i,parse:function(e,t){return this.parseOperator("||","binary",13)}},{regex:/^#(\w+)#/,parse:function(e,t){var r,s={token:"$smarty",tree:[]};this.parseVar(".config."+RegExp.$1,s,"smarty"),r.tree.push(s.tree[0]),this.parseModifiers(e,r)}},{regex:/^\s*\[\s*/,parse:function(e,t){var r=this.parseParams(e,/^\s*,\s*/,/^('[^'\\]*(?:\\.[^'\\]*)*'|"[^"\\]*(?:\\.[^"\\]*)*"|\w+)\s*=>\s*/),s=this.parsePluginFunc("__array",r),a=r.toString(),i=e.slice(r.toString().length).match(/\s*\]/);return i&&(a+=i[0]),{tree:s,value:a}}},{regex:/^[\d.]+/,parse:function(e,t){t.token.indexOf(".")>-1?t.token=parseFloat(t.token):t.token=parseInt(t.token,10);var r=this.parseText(t.token),s=this.parseModifiers(e,r);return s||r}},{regex:/^\w+/,parse:function(e,t){var r=this.parseText(t.token),s=this.parseModifiers(e,r);return s||r}}],buildInFunctions:{expression:{parse:function(e){var t=this.parseExpression(e);return{type:"build-in",name:"expression",expression:t.tree,params:this.parseParams(e.slice(t.value.length).replace(/^\s+|\s+$/g,""))}}},section:{type:"block",parse:function(e,t){var r=[],s=[],a=this.findElseTag("section [^}]+","/section","sectionelse",t);return a?(r=this.parse(t.slice(0,a.index)),s=this.parse(t.slice(a.index+a[0].length).replace(/^[\r\n]/,""))):r=this.parse(t),{type:"build-in",name:"section",params:e,subTree:r,subTreeElse:s}}},setfilter:{type:"block",parseParams:function(e){return[this.parseExpression("__t()|"+e).tree]},parse:function(e,t){return{type:"build-in",name:"setfilter",params:e,subTree:this.parse(t)}}},append:{type:"function",parse:function(e){return{type:"build-in",name:"append",params:e}}},assign:{type:"function",parse:function(e){return{type:"build-in",name:"assign",params:e}}},call:{type:"function",parse:function(e){return{type:"build-in",name:"call",params:e}}},capture:{type:"block",parse:function(e,t){return{type:"build-in",name:"capture",params:e,subTree:this.parse(t)}}},nocache:{type:"block",parse:function(e,t){return{type:"build-in",name:"nocache",params:e,subTree:this.parse(t)}}},include:{type:"function",parse:function(e){var t=r(e.file?e.file:e[0]),a=s(e,"nocache")>=0;return{type:"build-in",name:"include",params:e,subTree:this.loadTemplate(t,a)}}},for:{type:"block",parseParams:function(e){var t=e.match(/^\s*\$(\w+)\s*=\s*([^\s]+)\s*to\s*([^\s]+)\s*(?:step\s*([^\s]+))?\s*(.*)$/);if(!t)throw new Error("Invalid {for} parameters: "+e);return this.parseParams("varName='"+t[1]+"' from="+t[2]+" to="+t[3]+" step="+(t[4]?t[4]:"1")+" "+t[5])},parse:function(e,t){var r=[],s=[],a=this.findElseTag("for\\s[^}]+","/for","forelse",t);return a?(r=this.parse(t.slice(0,a.index)),s=this.parse(t.slice(a.index+a[0].length))):r=this.parse(t),{type:"build-in",name:"for",params:e,subTree:r,subTreeElse:s}}},if:{type:"block",parse:function(e,t){var r=[],s=[],a=this.findElseTag("if\\s+[^}]+","/if","else[^}]*",t);if(a){r=this.parse(t.slice(0,a.index)),t=t.slice(a.index+a[0].length);var i=a[1].match(/^else\s*if(.*)/);s=i?this.buildInFunctions.if.parse.call(this,this.parseParams(i[1]),t.replace(/^\n/,"")):this.parse(t.replace(/^\n/,""))}else r=this.parse(t);return[{type:"build-in",name:"if",params:e,subTreeIf:r,subTreeElse:s}]}},counter:{type:"function",parse:function(e){return{type:"build-in",name:"counter",params:e}}},foreach:{type:"block",parseParams:function(e){var t=e.match(/^\s*([$].+)\s*as\s*[$](\w+)\s*(=>\s*[$](\w+))?\s*$/i);return t&&(e="from="+t[1]+" item="+(t[4]||t[2]),t[4]&&(e+=" key="+t[2])),this.parseParams(e)},parse:function(e,t){var r=[],s=[],a=this.findElseTag("foreach\\s[^}]+","/foreach","foreachelse",t);return a?(r=this.parse(t.slice(0,a.index)),s=this.parse(t.slice(a.index+a[0].length).replace(/^[\r\n]/,""))):r=this.parse(t),{type:"build-in",name:"foreach",params:e,subTree:r,subTreeElse:s}}},function:{type:"block",parse:function(e,t){this.runTimePlugins[r(e.name?e.name:e[0])]=!0;var s=this.parse(t);return this.runTimePlugins[r(e.name?e.name:e[0])]={tree:s,defaultParams:e},!1}},php:{type:"block",parse:function(e,t){return!1}},extends:{type:"function",parse:function(e){return this.loadTemplate(r(e.file?e.file:e[0]))}},strip:{type:"block",parse:function(e,t){return this.parse(t.replace(/[ \t]*[\r\n]+[ \t]*/g,""))}},literal:{type:"block",parse:function(e,t){return this.parseText(t)}},ldelim:{type:"function",parse:function(e){return this.parseText(this.ldelim)}},rdelim:{type:"function",parse:function(e){return this.parseText(this.rdelim)}},while:{type:"block",parse:function(e,t){return{type:"build-in",name:"while",params:e,subTree:this.parse(t)}}}}},p={tplModifiers:[],runTimePlugins:{},plugins:{},modifiers:{},defaultModifiers:{},escapeHtml:!1,variableFilters:[],clear:function(){this.runTimePlugins={},this.variableFilters=[],this.escapeHtml=!1,this.defaultModifiers={},this.modifiers={},this.plugins={}},getProcessed:function(e,t){var r=this.process(e,t);return this.clear(),{output:r.tpl,smarty:r.smarty}},process:function(e,t){for(var r,s,a,i,n="",p=0;p<e.length;++p){if(s=e[p],r="","text"===s.type?r=s.data:"var"===s.type?r=this.getVarValue(s,t):"boolean"===s.type?r=!!s.data:"build-in"===s.type?void 0!==(a=this.buildInFunctions[s.name].process.call(this,s,t)).tpl?(r=a.tpl,t=a.data):r=a:"plugin"===s.type&&(this.runTimePlugins[s.name]?void 0!==(a=this.buildInFunctions.function.process.call(this,s,t)).tpl?(r=a.tpl,t=a.data):r=a:"block"===(i=this.plugins[s.name]).type||"function"===i.type&&(r=i.process(this.getActualParamValues(s.params,t),t))),"boolean"==typeof r&&1!==e.length&&(r=r?"1":""),null===r&&(r=""),1===e.length)return{tpl:r,data:t};if(n+=null!==r?r:"",t.smarty.continue||t.smarty.break)return{tpl:n,data:t}}return{tpl:n,data:t}},getActualParamValues:function(e,t){var r,s=[];for(var a in e.__parsed)e.__parsed.hasOwnProperty(a)&&(void 0!==(r=this.process([e.__parsed[a]],t))&&(t=r.data,r=r.tpl),s[a]=r);return s.__get=function(e,t,r){if(e in s&&void 0!==s[e])return s[e];if(void 0!==r&&void 0!==s[r])return s[r];if(null===t)throw new Error('The required attribute "'+e+'" is missing');return t},s},getVarValue:function(e,t,r){var s,a,i=t,n="";for(s=0;s<e.parts.length;++s)if("plugin"===(a=e.parts[s]).type&&"__func"===a.name&&a.hasOwner)t.__owner=i,void 0!==(i=this.process([e.parts[s]],t)).tpl&&(t=i.data,i=i.tpl),delete t.__owner;else{void 0!==(n=this.process([a],t))&&(t=n.data,n=n.tpl);var p=this.process([e.parts[0]],t);if(void 0!==p&&(t=p.data,p=p.tpl),n in t.smarty.section&&"text"===a.type&&"smarty"!==p&&(n=t.smarty.section[n].index),!n&&void 0!==r&&i instanceof Array&&(n=i.length),void 0!==r&&s===e.parts.length-1&&(i[n]=r),"object"==typeof i&&null!==i&&n in i)i=i[n];else{if(void 0===r)return r;i[n]={},i=i[n]}}return i},applyFilters:function(e,t){for(var r=0;r<e.length;++r)t=e[r](t);return t},assignVar:function(e,t,r){return e.match(/\[\]$/)?r[e.replace(/\[\]$/,"")].push(t):r[e]=t,r},buildInFunctions:{expression:{process:function(e,t){var r=this.getActualParamValues(e.params,t),a=this.process([e.expression],t);if(void 0!==a&&(t=a.data,a=a.tpl),s(r,"nofilter")<0){for(var i=0;i<this.defaultModifiers.length;++i){var n=this.defaultModifiers[i];n.params.__parsed[0]={type:"text",data:a},void 0!==(a=this.process([n],t))&&(t=a.data,a=a.tpl)}this.escapeHtml&&(a=this.modifiers.escape(a)),a=this.applyFilters(this.variableFilters,a),this.tplModifiers.length&&(window.__t=function(){return a},void 0!==(a=this.process(this.tplModifiers,t))&&(t=a.data,a=a.tpl))}return{tpl:a,data:t}}},append:{process:function(e,t){var r=this.getActualParamValues(e.params,t),s=r.__get("var",null,0);s in t&&t[s]instanceof Array||(t[s]=[]);var a=r.__get("index",!1),i=r.__get("value",null,1);return!1===a?t[s].push(i):t[s][a]=i,{tpl:"",data:t}}},assign:{process:function(e,t){var r=this.getActualParamValues(e.params,t);return{tpl:"",data:this.assignVar(r.__get("var",null,0),r.__get("value",null,1),t)}}},capture:{process:function(e,t){var r=this.getActualParamValues(e.params,t);e.name="cap-"+e.params.name;var s=this.process(e.subTree,t);void 0!==s&&(t=s.data,s=s.tpl),s=s.replace(/^\n/,""),t.smarty.capture[r.__get("name","default",0)]=s,"assign"in r&&(t=this.assignVar(r.assign,s,t));var a=r.__get("append",!1);return a&&(a in t?t[a]instanceof Array&&t[a].push(s):t[a]=[s]),{tpl:"",data:t}}},operator:{process:function(e,t){var r,s,a=this.getActualParamValues(e.params,t),i=a[0];if("binary"!==e.optype){if("!"===e.op)return!i;(s="var"===e.params.__parsed[0].type)&&(i=this.getVarValue(e.params.__parsed[0],t));var n=i;if("pre-unary"===e.optype){switch(e.op){case"-":n=-i;break;case"++":n=++i;break;case"--":n=--i}s&&this.getVarValue(e.params.__parsed[0],t,i)}else{switch(e.op){case"++":i++;break;case"--":i--}this.getVarValue(e.params.__parsed[0],t,i)}return n}if(r=a[1],"="===e.op)return this.getVarValue(e.params.__parsed[0],t,r),"";if(e.op.match(/(\+=|-=|\*=|\/=|%=)/)){switch(i=this.getVarValue(e.params.__parsed[0],t),e.op){case"+=":i+=r;break;case"-=":i-=r;break;case"*=":i*=r;break;case"/=":i/=r;break;case"%=":i%=r}return this.getVarValue(e.params.__parsed[0],t,i)}if(e.op.match(/div/))return"div"!==e.op^i%r==0;if(e.op.match(/even/))return"even"!==e.op^i/r%2==0;if(e.op.match(/xor/))return(i||r)&&!(i&&r);switch(e.op){case"==":return i==r;case"!=":return i!=r;case"+":return Number(i)+Number(r);case"-":return Number(i)-Number(r);case"*":return Number(i)*Number(r);case"/":return Number(i)/Number(r);case"%":return Number(i)%Number(r);case"&&":return i&&r;case"||":return i||r;case"<":return i<r;case"<=":return i<=r;case">":return i>r;case"===":return i===r;case">=":return i>=r;case"!==":return i!==r}}},section:{process:function(e,t){var r=this.getActualParamValues(e.params,t),s={},a=r.__get("show",!0);if(t.smarty.section[r.__get("name",null,0)]=s,s.show=a,!a)return this.process(e.subTreeElse,t);var n=parseInt(r.__get("start",0),10),p=r.loop instanceof Object?i(r.loop):isNaN(r.loop)?0:parseInt(r.loop),o=parseInt(r.__get("step",1),10),l=parseInt(r.__get("max"),10);isNaN(l)&&(l=Number.MAX_VALUE),n<0?(n+=p)<0&&(n=0):n>=p&&(n=p?p-1:0);var u=0,c=n;s.total=u,s.loop=u,u=0;var h="";for(c=n;c>=0&&c<p&&u<l&&!t.smarty.break;c+=o,++u){s.first=c===n,s.last=c+o<0||c+o>=p,s.index=c,s.index_prev=c-o,s.index_next=c+o,s.iteration=s.rownum=u+1;var f=this.process(e.subTree,t);void 0!==f&&(t=f.data,h+=f.tpl),t.smarty.continue=!1}return t.smarty.break=!1,u?{tpl:h,data:t}:this.process(e.subTreeElse,t)}},setfilter:{process:function(e,t){this.tplModifiers=e.params;var r=this.process(e.subTree,t);return void 0!==r&&(t=r.data,r=r.tpl),this.tplModifiers=[],{tpl:r,data:t}}},for:{process:function(e,t){var r=this.getActualParamValues(e.params,t),s=parseInt(r.__get("from"),10),a=parseInt(r.__get("to"),10),i=parseInt(r.__get("step"),10);isNaN(i)&&(i=1);var n=parseInt(r.__get("max"),10);isNaN(n)&&(n=Number.MAX_VALUE);for(var p=0,o="",l=Math.min(Math.ceil((1+(i>0?a-s:s-a))/Math.abs(i)),n),u=parseInt(r.from,10);p<l&&!t.smarty.break;u+=i,++p){t[r.varName]=u;var c=this.process(e.subTree,t);void 0!==c&&(t=c.data,o+=c.tpl),t.smarty.continue=!1}if(t.smarty.break=!1,!p){var h=this.process(e.subTreeElse,t);void 0!==h&&(t=h.data,o=h.tpl)}return{tpl:o,data:t}}},if:{process:function(e,t){var r=this.getActualParamValues(e.params,t)[0];return r&&!(r instanceof Array&&0===r.length||"object"==typeof r&&a(r))?this.process(e.subTreeIf,t):this.process(e.subTreeElse,t)}},nocache:{process:function(e,t){return this.process(e.subTree,t)}},foreach:{process:function(e,t){var r=this.getActualParamValues(e.params,t),s=r.from;void 0===s&&(s=[]),"object"!=typeof s&&(s=[s]);var a=i(s);t[r.item+"__total"]=a,"name"in r&&(t.smarty.foreach[r.name]={},t.smarty.foreach[r.name].total=a);var n="",p=0;for(var o in s)if(s.hasOwnProperty(o)){if(t.smarty.break)break;t[r.item+"__key"]=isNaN(o)?o:parseInt(o,10),"key"in r&&(t[r.key]=t[r.item+"__key"]),t[r.item]=s[o],t[r.item+"__index"]=parseInt(p,10),t[r.item+"__iteration"]=parseInt(p+1,10),t[r.item+"__first"]=0===p,t[r.item+"__last"]=p===a-1,"name"in r&&(t.smarty.foreach[r.name].index=parseInt(p,10),t.smarty.foreach[r.name].iteration=parseInt(p+1,10),t.smarty.foreach[r.name].first=0===p?1:"",t.smarty.foreach[r.name].last=p===a-1?1:""),++p;var l=this.process(e.subTree,t);void 0!==l&&(t=l.data,n+=l.tpl),t.smarty.continue=!1}return t.smarty.break=!1,t[r.item+"__show"]=p>0,r.name&&(t.smarty.foreach[r.name].show=p>0?1:""),p>0?n:this.process(e.subTreeElse,t)}},call:{process:function(e,t){var r=this.getActualParamValues(e.params,t),s={name:r.__get("name")?r.__get("name"):r.__get("0"),params:e.params},a=this.buildInFunctions.function.process.call(this,s,t),i=r.__get("assign",!1);return i?{tpl:"",data:this.assignVar(i,a,t)}:a}},include:{process:function(t,r){var s=this.getActualParamValues(t.params,r),a=s.__get("file",null,0),i=e({},r,s);i.smarty.template=a;var n=this.process(t.subTree,i);return void 0!==n&&(n=n.tpl),s.assign?{tpl:"",data:this.assignVar(s.assign,n,r)}:n}},counter:{process:function(e,t){var r=this.getActualParamValues(e.params,t),s=r.__get("name","default");if(s in t.smarty.counter){var a=t.smarty.counter[s];"start"in r?a.value=parseInt(r.start,10):(a.value=parseInt(a.value,10),a.skip=parseInt(a.skip,10),"down"===a.direction?a.value-=a.skip:a.value+=a.skip),a.skip=r.__get("skip",a.skip),a.direction=r.__get("direction",a.direction),a.assign=r.__get("assign",a.assign),t.smarty.counter[s]=a}else t.smarty.counter[s]={value:parseInt(r.__get("start",1),10),skip:parseInt(r.__get("skip",1),10),direction:r.__get("direction","up"),assign:r.__get("assign",!1)};return t.smarty.counter[s].assign?(t[t.smarty.counter[s].assign]=t.smarty.counter[s].value,{tpl:"",data:t}):r.__get("print",!0)?{tpl:t.smarty.counter[s].value,data:t}:{tpl:"",data:t}}},function:{process:function(t,r){var s=this.runTimePlugins[t.name],a=this.getActualParamValues(s.defaultParams,r);delete a.name;var i=this.getActualParamValues(t.params,r);return this.process(s.tree,e({},r,a,i)).tpl}},while:{process:function(e,t){for(var r="";this.getActualParamValues(e.params,t)[0]&&!t.smarty.break;){var s=this.process(e.subTree,t);void 0!==s&&(t=s.data,r+=s.tpl),t.smarty.continue=!1}return t.smarty.break=!1,{tpl:r,data:t}}}}},o=function(e,t){this.parse(e,t)};return(o.prototype={constructor:o,tree:[],scripts:{},modifiers:{},defaultModifiers:[],defaultModifiersGlobal:[],globalAndDefaultModifiers:[],filters:{variable:[],post:[]},filtersGlobal:{pre:[],variable:[],post:[]},globalAndDefaultFilters:[],buildInFunctions:{},plugins:{},autoLiteral:!0,escapeHtml:!1,debugging:!1,runTimePlugins:{},smarty:{block:{},break:!1,capture:{},continue:!1,counter:{},cycle:{},foreach:{},section:{},now:Math.floor((new Date).getTime()/1e3),const:{},config:{},current_dir:"/",template:"",ldelim:"{",rdelim:"}",version:"3.0.0"},parse:function(e,t){var r;t||(t={}),t.rdelim?this.smarty.rdelim=t.rdelim:o.prototype.right_delimiter&&(this.smarty.rdelim=o.prototype.right_delimiter),t.ldelim?this.smarty.ldelim=t.ldelim:o.prototype.left_delimiter&&(this.smarty.ldelim=o.prototype.left_delimiter),void 0!==t.autoLiteral?this.autoLiteral=t.autoLiteral:void 0!==o.prototype.auto_literal&&(this.autoLiteral=o.prototype.auto_literal),void 0!==t.debugging&&(this.debugging=t.debugging),void 0!==t.escapeHtml?this.escapeHtml=t.escapeHtml:void 0!==o.prototype.escape_html&&(this.escapeHtml=o.prototype.escape_html),e=String(e||""),n.clear(),n.rdelim=this.smarty.rdelim,n.ldelim=this.smarty.ldelim,n.getTemplate=this.getTemplate,n.autoLiteral=this.autoLiteral,n.plugins=this.plugins,n.preFilters=this.filtersGlobal.pre,r=n.getParsed(e),this.tree=r.tree,this.runTimePlugins=r.runTimePlugins},fetch:function(t){var r="";return"object"!=typeof t&&(t={}),t.smarty={},e(t.smarty,this.smarty),this.globalAndDefaultModifiers=o.prototype.defaultModifiersGlobal.concat(this.defaultModifiers),this.globalAndDefaultFilters=o.prototype.filtersGlobal.variable.concat(this.filters.variable),p.clear(),p.plugins=this.plugins,p.modifiers=this.modifiers,p.defaultModifiers=this.defaultModifiers,p.escapeHtml=this.escapeHtml,p.variableFilters=this.globalAndDefaultFilters,p.runTimePlugins=this.runTimePlugins,r=p.getProcessed(this.tree,t,this.smarty),e(this.smarty,r.smarty),this.applyFilters(o.prototype.filtersGlobal.post.concat(this.filters.post),r.output)},applyFilters:function(e,t){for(var r=0;r<e.length;++r)t=e[r](t);return t},registerPlugin:function(e,t,r){"modifier"===e?this.modifiers[t]=r:this.plugins[t]={type:e,process:r}},registerFilter:function(e,t){(this.tree?this.filters:o.prototype.filtersGlobal)["output"===e?"post":e].push(t)},addDefaultModifier:function(e){e instanceof Array||(e=[e]);for(var t=0;t<e.length;++t){var r=n.parseModifiers("|"+e[t],[0]);this.tree?this.defaultModifiers.push(r.tree[0]):this.defaultModifiersGlobal.push(r.tree[0])}},getTemplate:function(e){throw new Error("No template for "+e)},getFile:function(e){throw new Error("No file for "+e)},getJavascript:function(e){throw new Error("No Javascript for "+e)},getConfig:function(e){throw new Error("No config for "+e)}}).registerPlugin("modifier","defaultValue",function(e,t){return t=t||"",e&&"null"!==e&&void 0!==e?e:t}),o.prototype.registerPlugin("modifier","upper",function(e){return String(e).toUpperCase()}),o.prototype.registerPlugin("modifier","lower",function(e){return String(e).toLowerCase()}),o.prototype.registerPlugin("modifier","replace",function(e,t,r){if(!t)return e;e=String(e),t=String(t),r=String(r);var s="",a=-1;for(a=e.indexOf(t);a>=0;a=e.indexOf(t))s+=e.slice(0,a)+r,a+=t.length,e=e.slice(a);return s+e}),o.prototype.registerPlugin("modifier","count_characters",function(e,t){return e=String(e),t?e.length:e.replace(/\s/g,"").length}),o.prototype.registerPlugin("function","__quoted",function(e,t){return e.join("")}),o.prototype.registerPlugin("function","__array",function(e,t){var r=[];for(var s in e)e.hasOwnProperty(s)&&e[s]&&"function"!=typeof e[s]&&(r[s]=e[s]);return r}),o.prototype.registerPlugin("function","__func",function(e,t){var r,s,a=[];for(r=0;r<e.length;++r)a.push(e[r]);if("__owner"in t&&e.name in t.__owner)return s=t.__owner,e.length?s[e.name].apply(s,e):s[e.name].apply(s);if(o.prototype.modifiers.hasOwnProperty(e.name))return(s=o.prototype.modifiers[e.name]).apply(s,a);s=e.name;var i;return"object"==typeof module&&module&&"object"==typeof module.exports?i=global[s]:window&&window.document&&(i=window[s]),t[s]?t[s].apply(t[s],a):i?i.apply(i,a):""}),o});