/*!
 * jSmart JavaScript template engine (v3.0.0)
 * https://github.com/umakantp/jsmart
 * https://opensource.org/licenses/MIT
 *
 * Copyright 2011-2017, Umakant Patil <me at umakantpatil dot com>
 *                      Max Miroshnikov <miroshnikov at gmail dot com>
 */

!function(e){"use strict";"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=e():(window&&window.document&&(window.jSmart=e()),"function"==typeof define&&define.amd&&define("jSmart",[],e))}(function(){"use strict";function e(e,r){for(var t=1;t<arguments.length;++t)for(var s in arguments[t])e[s]=arguments[t][s];return e}function r(e){return e.replace(/\\t/,"\t").replace(/\\n/,"\n").replace(/\\(['"\\])/g,"$1")}function t(e){return r(e.replace(/^['"](.*)['"]$/,"$1")).replace(/^\s+|\s+$/g,"")}function s(e,r){if(Array.prototype.indexOf)return e.indexOf(r);for(var t=0;t<e.length;++t)if(e[t]===r)return t;return-1}function a(e){for(var r in e)if(e.hasOwnProperty(r))return!1;return!0}function i(e){var r=0;for(var t in e)e.hasOwnProperty(t)&&r++;return r}var n={files:{},ldelim:"{",rdelim:"}",autoLiteral:!0,runTimePlugins:{},plugins:{},preFilters:[],getTemplate:function(e){throw new Error("no getTemplate function defined.")},clear:function(){this.runTimePlugins={},this.preFilters=[],this.autoLiteral=!0,this.plugins={},this.ldelim="{",this.rdelim="}"},getParsed:function(e){var r,t=[];return e=this.removeComments(e),e=e.replace(/\r\n/g,"\n"),e=this.applyFilters(this.preFilters,e),t=this.parse(e),r=this.runTimePlugins,this.clear(),{tree:t,runTimePlugins:r}},parse:function(e){var r,t,s,a,i,n,p=[];for(r=this.findTag("",e);r;r=this.findTag("",e))if(r.index&&(p=p.concat(this.parseText(e.slice(0,r.index)))),e=e.slice(r.index+r[0].length),t=r[1].match(/^\s*(\w+)(.*)$/))if(s=t[1],a=t.length>2?t[2].replace(/^\s+|\s+$/g,""):"",s in this.buildInFunctions){var o=this.buildInFunctions[s],l=("parseParams"in o?o.parseParams.bind(this):this.parseParams.bind(this))(a);if("block"===o.type){e=e.replace(/^\n/,""),n=this.findCloseTag("/"+s,s+" +[^}]*",e);var u=o.parse.call(this,l,e.slice(0,n.index));u&&(p=p.concat(u)),e=e.slice(n.index+n[0].length)}else"extends"===s&&p.splice(0,p.length),p=p.concat(o.parse.call(this,l));e=e.replace(/^\n/,"")}else if(s in this.runTimePlugins)p=p.concat(this.parsePluginFunc(s,this.parseParams(a)));else if(s in this.plugins){var c=this.plugins[s];"block"===c.type?(n=this.findCloseTag("/"+s,s+" +[^}]*",e),p=p.concat(this.parsePluginBlock(s,this.parseParams(a),e.slice(0,n.index))),e=e.slice(n.index+n[0].length)):"function"===c.type&&(p=p.concat(this.parsePluginFunc(s,this.parseParams(a)))),"append"!==s&&"assign"!==s&&"capture"!==s&&"eval"!==s&&"include"!==s||(e=e.replace(/^\n/,""))}else i=this.buildInFunctions.expression.parse.call(this,r[1]),p.push(i);else"build-in"===(i=this.buildInFunctions.expression.parse.call(this,r[1])).expression.type&&"operator"===i.expression.name&&"="===i.expression.op&&(e=e.replace(/^\n/,"")),p.push(i);return e&&(p=p.concat(this.parseText(e))),p},findTag:function(e,r){var t,s,a,i=0,n=0,p=this.ldelim,o=this.rdelim,l=this.autoLiteral,u=/^\s*(.+)\s*$/i,c=e?new RegExp("^\\s*("+e+")\\s*$","i"):u;for(t=0;t<r.length;++t)if(r.substr(t,p.length)===p){if(l&&t+1<r.length&&r.substr(t+1,1).match(/\s/))continue;i||(r=r.slice(t),n+=parseInt(t),t=0),++i}else if(r.substr(t,o.length)===o){if(l&&t-1>=0&&r.substr(t-1,1).match(/\s/))continue;if(!--i&&(s=r.slice(p.length,t).replace(/[\r\n]/g," "),a=s.match(c)))return a.index=n,a[0]=r.slice(0,t+o.length),a;i<0&&(i=0)}return null},findElseTag:function(e,r,t,s){for(var a=0,i=this.findTag(t,s);i;i=this.findTag(t,s)){var n=this.findTag(e,s);if(!n||n.index>i.index)return i.index+=a,i;s=s.slice(n.index+n[0].length),a+=n.index+n[0].length;var p=this.findCloseTag(r,e,s);s=s.slice(p.index+p[0].length),a+=p.index+p[0].length}return null},findCloseTag:function(e,r,t){var s="",a=null,i=null,n=0;do{if(a&&(n+=a[0].length),!(a=this.findTag(e,t)))throw new Error("Unclosed "+this.ldelim+r+this.rdelim);s+=t.slice(0,a.index),n+=a.index,t=t.slice(a.index+a[0].length),(i=this.findTag(r,s))&&(s=s.slice(i.index+i[0].length))}while(i);return a.index=n,a},bundleOp:function(e,r,t){var s=r[e];if("operator"===s.name&&s.precedence===t&&!s.params.__parsed){if("binary"===s.optype)return s.params.__parsed=[r[e-1],r[e+1]],r.splice(e-1,3,s),[!0,r];if("post-unary"===s.optype)return s.params.__parsed=[r[e-1]],r.splice(e-1,2,s),[!0,r];s.params.__parsed=[r[e+1]],r.splice(e,2,s)}return[!1,r]},composeExpression:function(e){var r,t=0;for(t=0;t<e.length;++t)e[t]instanceof Array&&(e[t]=this.composeExpression(e[t]));for(var s=1;s<14;++s)if(2===s||10===s)for(t=e.length;t>0;--t)t-=(r=this.bundleOp(t-1,e,s))[0],e=r[1];else for(t=0;t<e.length;++t)t-=(r=this.bundleOp(t,e,s))[0],e=r[1];return e[0]},getMatchingToken:function(e){for(var r=0;r<this.tokens.length;++r)if(e.match(this.tokens[r].regex))return r;return!1},parseVar:function(e,r,t){var s,a,i=/^(?:\.|\s*->\s*|\[\s*)/,n={value:"",tree:[]},p="",o=[{type:"text",data:r}],l=t;for(t||(l=t=r),s=e.match(i);s;s=e.match(i)){if(t+=s[0],e=e.slice(s[0].length),s[0].match(/\[/)){(n=this.parseExpression(e,!0)).tree&&(t+=n.value,o.push(n.tree),e=e.slice(n.value.length));var u=e.match(/\s*\]/);u&&(t+=u[0],e=e.slice(u[0].length))}else{var c=this.parseModifiersStop;if(this.parseModifiersStop=!0,a=this.lookUp(e,""))if(n.tree=[].concat(n.tree,a.tree),n.value=a.value,t+=a.value,a.ret){var h=n.tree[n.tree.length-1];"plugin"===h.type&&"__func"===h.name&&(h.hasOwner=!0),o.push(h),e=e.slice(n.value.length)}else n=!1;this.parseModifiersStop=c}n||o.push({type:"text",data:""})}return p=t.substr(l.length),{s:e,token:t,tree:[{type:"var",parts:o}],value:p}},parseFunc:function(e,r,t){return r.__parsed.name=this.parseText(e,[])[0],t.push({type:"plugin",name:"__func",params:r}),t},parseOperator:function(e,r,t){return[{type:"build-in",name:"operator",op:e,optype:r,precedence:t,params:{}}]},parsePluginBlock:function(e,r,t){return[{type:"plugin",name:e,params:r,subTree:this.parse(t,[])}]},parsePluginFunc:function(e,r){return[{type:"plugin",name:e,params:r}]},parseModifiers:function(e,r){var t,s=e.match(/^\|(\w+)/),a="";if(!this.parseModifiersStop&&s){a+=s[0],t="default"===s[1]?"defaultValue":s[1],e=e.slice(s[0].length).replace(/^\s+/,""),this.parseModifiersStop=!0;for(var i=[],n=e.match(/^\s*:\s*/);n;n=e.match(/^\s*:\s*/)){a+=e.slice(0,n[0].length),e=e.slice(n[0].length);var p=this.lookUp(e,"");p.ret?(a+=p.value,i.push(p.tree[0]),e=e.slice(p.value.length)):i.push(this.parseText(""))}this.parseModifiersStop=!1,i.unshift(r.pop());var o=this.parseFunc(t,{__parsed:i},[]);r.push(o[0]);var l=this.parseModifiers(e,r);return l&&(r=r.concat(l.tree)),{value:a,tree:r}}},parseParams:function(e,r,s){var a=e.replace(/\n/g," ").replace(/^\s+|\s+$/g,""),i=[];if(e="",i.__parsed=[],!a)return i;for(r||(r=/^\s+/,s=/^(\w+)\s*=\s*/);a;){var n=null;if(s){var p=a.match(s);if(p){var o=p[1].charAt(0).match(/^\d+/);"true"!==p[1]&&"false"!==p[1]&&"null"!==p[1]||(o=!0),o||(n=t(p[1]),e+=a.slice(0,p[0].length),a=a.slice(p[0].length))}}var l=this.parseExpression(a);if(!l)break;n?(i[n]=l.value,i.__parsed[n]=l.tree):(i.push(l.value),i.__parsed.push(l.tree)),e+=a.slice(0,l.value.length);var u=(a=a.slice(l.value.length)).match(r);if(!u)break;e+=a.slice(0,u[0].length),a=a.slice(u[0].length)}return i.toString=function(){return e},i},lookUp:function(e,r){var t,s=[];if(!e)return!1;if(e.substr(0,this.ldelim.length)===this.ldelim&&(t=this.findTag("",e),r+=t[0],t)){var a=this.parse(t[0]);s=s.concat(a);var i=this.parseModifiers(e.slice(r.length),s);return i?{ret:!0,tree:i.tree,value:i.value}:{ret:!0,tree:s,value:r}}var n=this.getMatchingToken(e);if(!1!==n){r+=RegExp.lastMatch;var p=this.tokens[n].parse.call(this,e.slice(RegExp.lastMatch.length),{tree:s,token:RegExp.lastMatch});if("string"==typeof p)if("parenStart"===p){var o=[];s.push(o),o.parent=s,s=o}else"parenEnd"===p&&s.parent&&(s=s.parent);else p&&p.constructor===Object?(r+=p.value,p=p.tree,s=s.concat(p)):s=s.concat(p);return{ret:!0,tree:s,value:r}}return{ret:!1,tree:s,value:r}},parseExpression:function(e){var r,t=[],s="";for(this.lastTreeInExpression=t;;){if(!(r=this.lookUp(e.slice(s.length),s)))break;if(t=t.concat(r.tree),s=r.value,this.lastTreeInExpression=t,!r.ret)break}return t.length&&(t=this.composeExpression(t)),{tree:t,value:s}},parseBool:function(e){return[{type:"boolean",data:e}]},parseText:function(e){var r=[];if(this.parseEmbeddedVars)for(var t=/([$][\w@]+)|`([^`]*)`/,s=t.exec(e);s;s=t.exec(e)){r.push({type:"text",data:e.slice(0,s.index)});var a=this.parseExpression(s[1]?s[1]:s[2]);r.push(a.tree),e=e.slice(s.index+s[0].length)}return r.push({type:"text",data:e}),r},loadTemplate:function(e,r){var t=[];if(!r&&e in this.files)t=this.files[e];else{var s=this.getTemplate(e);if("string"!=typeof s)throw new Error("No template for "+e);s=this.removeComments(s.replace(/\r\n/g,"\n")),s=this.applyFilters(this.preFilters,s),t=this.parse(s),this.files[e]=t}return t},removeComments:function(e){for(var r=new RegExp(this.ldelim+"\\*"),t=new RegExp("\\*"+this.rdelim),s="",a=e.match(r);a;a=e.match(t)){s+=e.slice(0,a.index);var i=(e=e.slice(a.index+a[0].length)).match(t);if(!i)throw new Error("Unclosed "+r+"*");e=e.slice(i.index+i[0].length)}return s+e},applyFilters:function(e,r){for(var t=0;t<e.length;++t)r=e[t](r);return r},tokens:[{regex:/^\$([\w@]+)/,parse:function(e,r){var t=this.parseVar(e,RegExp.$1,RegExp.$1),s=this.parseModifiers(t.s,t.tree);return s?(t.value+=s.value,s):t}},{regex:/^(true|false)/i,parse:function(e,r){return r.token.match(/true/i)?this.parseBool(!0):this.parseBool(!1)}},{regex:/^'([^'\\]*(?:\\.[^'\\]*)*)'/,parse:function(e,t){var s=r(RegExp.$1),a=this.parseText(s),i=this.parseModifiers(e,a);return i||a}},{regex:/^"([^"\\]*(?:\\.[^"\\]*)*)"/,parse:function(e,t){var s=r(RegExp.$1),a=s.match(this.tokens[0].regex);if(a){var i=this.parseVar(s,a[1],a[0]);if(i.token.length===s.length)return[i.tree[0]]}this.parseEmbeddedVars=!0;var n=[];n.push({type:"plugin",name:"__quoted",params:{__parsed:this.parse(s,[])}}),this.parseEmbeddedVars=!1;var p=this.parseModifiers(e,n);return p||n}},{regex:/^(\w+)\s*[(]([)]?)/,parse:function(e,r){var t=RegExp.$1,s=RegExp.$2,a=this.parseParams(s?"":e,/^\s*,\s*/),i=this.parseFunc(t,a,[]),n=this.parseModifiers(e.slice(a.toString().length),i);return n||i}},{regex:/^\s*\(\s*/,parse:function(e,r){return"parenStart"}},{regex:/^\s*\)\s*/,parse:function(e,r){return"parenEnd"}},{regex:/^\s*(\+\+|--)\s*/,parse:function(e,r){return this.lastTreeInExpression.length&&"var"===this.lastTreeInExpression[this.lastTreeInExpression.length-1].type?this.parseOperator(RegExp.$1,"post-unary",1):this.parseOperator(RegExp.$1,"pre-unary",1)}},{regex:/^\s*(===|!==|==|!=)\s*/,parse:function(e,r){return this.parseOperator(RegExp.$1,"binary",6)}},{regex:/^\s+(eq|ne|neq)\s+/i,parse:function(e,r){var t=RegExp.$1.replace(/ne(q)?/,"!=").replace(/eq/,"==");return this.parseOperator(t,"binary",6)}},{regex:/^\s*!\s*/,parse:function(e,r){return this.parseOperator("!","pre-unary",2)}},{regex:/^\s+not\s+/i,parse:function(e,r){return this.parseOperator("!","pre-unary",2)}},{regex:/^\s*(=|\+=|-=|\*=|\/=|%=)\s*/,parse:function(e,r){return this.parseOperator(RegExp.$1,"binary",10)}},{regex:/^\s*(\*|\/|%)\s*/,parse:function(e,r){return this.parseOperator(RegExp.$1,"binary",3)}},{regex:/^\s+mod\s+/i,parse:function(e,r){return this.parseOperator("%","binary",3)}},{regex:/^\s*(\+|-)\s*/,parse:function(e,r){return this.lastTreeInExpression.length&&"operator"!==this.lastTreeInExpression[this.lastTreeInExpression.length-1].name?this.parseOperator(RegExp.$1,"binary",4):this.parseOperator(RegExp.$1,"pre-unary",4)}},{regex:/^\s*(<=|>=|<>|<|>)\s*/,parse:function(e,r){return this.parseOperator(RegExp.$1.replace(/<>/,"!="),"binary",5)}},{regex:/^\s+(lt|lte|le|gt|gte|ge)\s+/i,parse:function(e,r){var t=RegExp.$1.replace(/l(t)?e/,"<").replace(/lt/,"<=").replace(/g(t)?e/,">").replace(/gt/,">=");return this.parseOperator(t,"binary",5)}},{regex:/^\s+(is\s+(not\s+)?div\s+by)\s+/i,parse:function(e,r){return this.parseOperator(RegExp.$2?"div_not":"div","binary",7)}},{regex:/^\s+is\s+(not\s+)?(even|odd)(\s+by\s+)?\s*/i,parse:function(e,r){var t=RegExp.$1?"odd"===RegExp.$2?"even":"even_not":"odd"===RegExp.$2?"even_not":"even",s=this.parseOperator(t,"binary",7);return RegExp.$3?s:s.concat(this.parseText("1",s))}},{regex:/^\s*(&&)\s*/,parse:function(e,r){return this.parseOperator(RegExp.$1,"binary",8)}},{regex:/^\s*(\|\|)\s*/,parse:function(e,r){return this.parseOperator(RegExp.$1,"binary",9)}},{regex:/^\s+and\s+/i,parse:function(e,r){return this.parseOperator("&&","binary",11)}},{regex:/^\s+xor\s+/i,parse:function(e,r){return this.parseOperator("xor","binary",12)}},{regex:/^\s+or\s+/i,parse:function(e,r){return this.parseOperator("||","binary",13)}},{regex:/^#(\w+)#/,parse:function(e,r){var t,s={token:"$smarty",tree:[]};this.parseVar(".config."+RegExp.$1,s,"smarty"),t.tree.push(s.tree[0]),this.parseModifiers(e,t)}},{regex:/^\s*\[\s*/,parse:function(e,r){var t=this.parseParams(e,/^\s*,\s*/,/^('[^'\\]*(?:\\.[^'\\]*)*'|"[^"\\]*(?:\\.[^"\\]*)*"|\w+)\s*=>\s*/),s=this.parsePluginFunc("__array",t),a=t.toString(),i=e.slice(t.toString().length).match(/\s*\]/);return i&&(a+=i[0]),{tree:s,value:a}}},{regex:/^[\d.]+/,parse:function(e,r){r.token.indexOf(".")>-1?r.token=parseFloat(r.token):r.token=parseInt(r.token,10);var t=this.parseText(r.token),s=this.parseModifiers(e,t);return s||t}},{regex:/^\w+/,parse:function(e,r){var t=this.parseText(r.token),s=this.parseModifiers(e,t);return s||t}}],buildInFunctions:{expression:{parse:function(e){var r=this.parseExpression(e);return{type:"build-in",name:"expression",expression:r.tree,params:this.parseParams(e.slice(r.value.length).replace(/^\s+|\s+$/g,""))}}},section:{type:"block",parse:function(e,r){var t=[],s=[],a=this.findElseTag("section [^}]+","/section","sectionelse",r);return a?(t=this.parse(r.slice(0,a.index)),s=this.parse(r.slice(a.index+a[0].length).replace(/^[\r\n]/,""))):t=this.parse(r),{type:"build-in",name:"section",params:e,subTree:t,subTreeElse:s}}},setfilter:{type:"block",parseParams:function(e){return[this.parseExpression("__t()|"+e).tree]},parse:function(e,r){return{type:"build-in",name:"setfilter",params:e,subTree:this.parse(r)}}},append:{type:"function",parse:function(e){return{type:"build-in",name:"append",params:e}}},assign:{type:"function",parse:function(e){return{type:"build-in",name:"assign",params:e}}},call:{type:"function",parse:function(e){return{type:"build-in",name:"call",params:e}}},capture:{type:"block",parse:function(e,r){return{type:"build-in",name:"capture",params:e,subTree:this.parse(r)}}},nocache:{type:"block",parse:function(e,r){return{type:"build-in",name:"nocache",params:e,subTree:this.parse(r)}}},include:{type:"function",parse:function(e){var r=t(e.file?e.file:e[0]),a=s(e,"nocache")>=0;return{type:"build-in",name:"include",params:e,subTree:this.loadTemplate(r,a)}}},for:{type:"block",parseParams:function(e){var r=e.match(/^\s*\$(\w+)\s*=\s*([^\s]+)\s*to\s*([^\s]+)\s*(?:step\s*([^\s]+))?\s*(.*)$/);if(!r)throw new Error("Invalid {for} parameters: "+e);return this.parseParams("varName='"+r[1]+"' from="+r[2]+" to="+r[3]+" step="+(r[4]?r[4]:"1")+" "+r[5])},parse:function(e,r){var t=[],s=[],a=this.findElseTag("for\\s[^}]+","/for","forelse",r);return a?(t=this.parse(r.slice(0,a.index)),s=this.parse(r.slice(a.index+a[0].length))):t=this.parse(r),{type:"build-in",name:"for",params:e,subTree:t,subTreeElse:s}}},if:{type:"block",parse:function(e,r){var t=[],s=[],a=this.findElseTag("if\\s+[^}]+","/if","else[^}]*",r);if(a){t=this.parse(r.slice(0,a.index)),r=r.slice(a.index+a[0].length);var i=a[1].match(/^else\s*if(.*)/);s=i?this.buildInFunctions.if.parse.call(this,this.parseParams(i[1]),r.replace(/^\n/,"")):this.parse(r.replace(/^\n/,""))}else t=this.parse(r);return[{type:"build-in",name:"if",params:e,subTreeIf:t,subTreeElse:s}]}},counter:{type:"function",parse:function(e){return{type:"build-in",name:"counter",params:e}}},foreach:{type:"block",parseParams:function(e){var r=e.match(/^\s*([$].+)\s*as\s*[$](\w+)\s*(=>\s*[$](\w+))?\s*$/i);return r&&(e="from="+r[1]+" item="+(r[4]||r[2]),r[4]&&(e+=" key="+r[2])),this.parseParams(e)},parse:function(e,r){var t=[],s=[],a=this.findElseTag("foreach\\s[^}]+","/foreach","foreachelse",r);return a?(t=this.parse(r.slice(0,a.index)),s=this.parse(r.slice(a.index+a[0].length).replace(/^[\r\n]/,""))):t=this.parse(r),{type:"build-in",name:"foreach",params:e,subTree:t,subTreeElse:s}}},function:{type:"block",parse:function(e,r){this.runTimePlugins[t(e.name?e.name:e[0])]=!0;var s=this.parse(r);return this.runTimePlugins[t(e.name?e.name:e[0])]={tree:s,defaultParams:e},!1}},php:{type:"block",parse:function(e,r){return!1}},extends:{type:"function",parse:function(e){return this.loadTemplate(t(e.file?e.file:e[0]))}},strip:{type:"block",parse:function(e,r){return this.parse(r.replace(/[ \t]*[\r\n]+[ \t]*/g,""))}},literal:{type:"block",parse:function(e,r){return this.parseText(r)}},ldelim:{type:"function",parse:function(e){return this.parseText(this.ldelim)}},rdelim:{type:"function",parse:function(e){return this.parseText(this.rdelim)}},while:{type:"block",parse:function(e,r){return{type:"build-in",name:"while",params:e,subTree:this.parse(r)}}}}},p={tplModifiers:[],runTimePlugins:{},plugins:{},modifiers:{},defaultModifiers:{},escapeHtml:!1,variableFilters:[],clear:function(){this.runTimePlugins={},this.variableFilters=[],this.escapeHtml=!1,this.defaultModifiers={},this.modifiers={},this.plugins={}},getProcessed:function(e,r){var t=this.process(e,r);return this.clear(),{output:t.tpl,smarty:t.smarty}},process:function(e,r){for(var t,s,a,i,n="",p=0;p<e.length;++p){if(s=e[p],t="","text"===s.type?t=s.data:"var"===s.type?t=this.getVarValue(s,r):"boolean"===s.type?t=s.data?"1":"":"build-in"===s.type?void 0!==(a=this.buildInFunctions[s.name].process.call(this,s,r)).tpl?(t=a.tpl,r=a.data):t=a:"plugin"===s.type&&(this.runTimePlugins[s.name]?void 0!==(a=this.buildInFunctions.function.process.call(this,s,r)).tpl?(t=a.tpl,r=a.data):t=a:"block"===(i=this.plugins[s.name]).type||"function"===i.type&&(t=i.process(this.getActualParamValues(s.params,r),r))),"boolean"==typeof t&&(t=t?"1":""),null===t&&(t=""),1===e.length)return{tpl:t,data:r};if(n+=null!==t?t:"",r.smarty.continue||r.smarty.break)return{tpl:n,data:r}}return{tpl:n,data:r}},getActualParamValues:function(e,r){var t,s=[];for(var a in e.__parsed)e.__parsed.hasOwnProperty(a)&&(void 0!==(t=this.process([e.__parsed[a]],r))&&(r=t.data,t=t.tpl),s[a]=t);return s.__get=function(e,r,t){if(e in s&&void 0!==s[e])return s[e];if(void 0!==t&&void 0!==s[t])return s[t];if(null===r)throw new Error('The required attribute "'+e+'" is missing');return r},s},getVarValue:function(e,r,t){var s,a,i=r,n="";for(s=0;s<e.parts.length;++s)if("plugin"===(a=e.parts[s]).type&&"__func"===a.name&&a.hasOwner)r.__owner=i,void 0!==(i=this.process([e.parts[s]],r)).tpl&&(r=i.data,i=i.tpl),delete r.__owner;else{void 0!==(n=this.process([a],r))&&(r=n.data,n=n.tpl);var p=this.process([e.parts[0]],r);if(void 0!==p&&(r=p.data,p=p.tpl),n in r.smarty.section&&"text"===a.type&&"smarty"!==p&&(n=r.smarty.section[n].index),!n&&void 0!==t&&i instanceof Array&&(n=i.length),void 0!==t&&s===e.parts.length-1&&(i[n]=t),"object"==typeof i&&null!==i&&n in i)i=i[n];else{if(void 0===t)return t;i[n]={},i=i[n]}}return i},applyFilters:function(e,r){for(var t=0;t<e.length;++t)r=e[t](r);return r},assignVar:function(e,r,t){return e.match(/\[\]$/)?t[e.replace(/\[\]$/,"")].push(r):t[e]=r,t},buildInFunctions:{expression:{process:function(e,r){var t=this.getActualParamValues(e.params,r),a=this.process([e.expression],r);if(void 0!==a&&(r=a.data,a=a.tpl),s(t,"nofilter")<0){for(var i=0;i<this.defaultModifiers.length;++i){var n=this.defaultModifiers[i];n.params.__parsed[0]={type:"text",data:a},void 0!==(a=this.process([n],r))&&(r=a.data,a=a.tpl)}this.escapeHtml&&(a=this.modifiers.escape(a)),a=this.applyFilters(this.variableFilters,a),this.tplModifiers.length&&(window.__t=function(){return a},void 0!==(a=this.process(this.tplModifiers,r))&&(r=a.data,a=a.tpl))}return{tpl:a,data:r}}},append:{process:function(e,r){var t=this.getActualParamValues(e.params,r),s=t.__get("var",null,0);s in r&&r[s]instanceof Array||(r[s]=[]);var a=t.__get("index",!1),i=t.__get("value",null,1);return!1===a?r[s].push(i):r[s][a]=i,{tpl:"",data:r}}},assign:{process:function(e,r){var t=this.getActualParamValues(e.params,r);return{tpl:"",data:this.assignVar(t.__get("var",null,0),t.__get("value",null,1),r)}}},capture:{process:function(e,r){var t=this.getActualParamValues(e.params,r);e.name="cap-"+e.params.name;var s=this.process(e.subTree,r);void 0!==s&&(r=s.data,s=s.tpl),s=s.replace(/^\n/,""),r.smarty.capture[t.__get("name","default",0)]=s,"assign"in t&&(r=this.assignVar(t.assign,s,r));var a=t.__get("append",!1);return a&&(a in r?r[a]instanceof Array&&r[a].push(s):r[a]=[s]),{tpl:"",data:r}}},operator:{process:function(e,r){var t,s,a=this.getActualParamValues(e.params,r),i=a[0];if("binary"!==e.optype){if("!"===e.op)return!i;(s="var"===e.params.__parsed[0].type)&&(i=this.getVarValue(e.params.__parsed[0],r));var n=i;if("pre-unary"===e.optype){switch(e.op){case"-":n=-i;break;case"++":n=++i;break;case"--":n=--i}s&&this.getVarValue(e.params.__parsed[0],r,i)}else{switch(e.op){case"++":i++;break;case"--":i--}this.getVarValue(e.params.__parsed[0],r,i)}return n}if(t=a[1],"="===e.op)return this.getVarValue(e.params.__parsed[0],r,t),"";if(e.op.match(/(\+=|-=|\*=|\/=|%=)/)){switch(i=this.getVarValue(e.params.__parsed[0],r),e.op){case"+=":i+=t;break;case"-=":i-=t;break;case"*=":i*=t;break;case"/=":i/=t;break;case"%=":i%=t}return this.getVarValue(e.params.__parsed[0],r,i)}if(e.op.match(/div/))return"div"!==e.op^i%t==0;if(e.op.match(/even/))return"even"!==e.op^i/t%2==0;if(e.op.match(/xor/))return(i||t)&&!(i&&t);switch(e.op){case"==":return i==t;case"!=":return i!=t;case"+":return Number(i)+Number(t);case"-":return Number(i)-Number(t);case"*":return Number(i)*Number(t);case"/":return Number(i)/Number(t);case"%":return Number(i)%Number(t);case"&&":return i&&t;case"||":return i||t;case"<":return i<t;case"<=":return i<=t;case">":return i>t;case"===":return i===t;case">=":return i>=t;case"!==":return i!==t}}},section:{process:function(e,r){var t=this.getActualParamValues(e.params,r),s={},a=t.__get("show",!0);if(r.smarty.section[t.__get("name",null,0)]=s,s.show=a,!a)return this.process(e.subTreeElse,r);var n=parseInt(t.__get("start",0),10),p=t.loop instanceof Object?i(t.loop):isNaN(t.loop)?0:parseInt(t.loop),o=parseInt(t.__get("step",1),10),l=parseInt(t.__get("max"),10);isNaN(l)&&(l=Number.MAX_VALUE),n<0?(n+=p)<0&&(n=0):n>=p&&(n=p?p-1:0);var u=0,c=n;s.total=u,s.loop=u,u=0;var h="";for(c=n;c>=0&&c<p&&u<l&&!r.smarty.break;c+=o,++u){s.first=c===n,s.last=c+o<0||c+o>=p,s.index=c,s.index_prev=c-o,s.index_next=c+o,s.iteration=s.rownum=u+1;var f=this.process(e.subTree,r);void 0!==f&&(r=f.data,h+=f.tpl),r.smarty.continue=!1}return r.smarty.break=!1,u?{tpl:h,data:r}:this.process(e.subTreeElse,r)}},setfilter:{process:function(e,r){this.tplModifiers=e.params;var t=this.process(e.subTree,r);return void 0!==t&&(r=t.data,t=t.tpl),this.tplModifiers=[],{tpl:t,data:r}}},for:{process:function(e,r){var t=this.getActualParamValues(e.params,r),s=parseInt(t.__get("from"),10),a=parseInt(t.__get("to"),10),i=parseInt(t.__get("step"),10);isNaN(i)&&(i=1);var n=parseInt(t.__get("max"),10);isNaN(n)&&(n=Number.MAX_VALUE);for(var p=0,o="",l=Math.min(Math.ceil((1+(i>0?a-s:s-a))/Math.abs(i)),n),u=parseInt(t.from,10);p<l&&!r.smarty.break;u+=i,++p){r[t.varName]=u;var c=this.process(e.subTree,r);void 0!==c&&(r=c.data,o+=c.tpl),r.smarty.continue=!1}if(r.smarty.break=!1,!p){var h=this.process(e.subTreeElse,r);void 0!==h&&(r=h.data,o=h.tpl)}return{tpl:o,data:r}}},if:{process:function(e,r){var t=this.getActualParamValues(e.params,r)[0];return t&&!(t instanceof Array&&0===t.length||"object"==typeof t&&a(t))?this.process(e.subTreeIf,r):this.process(e.subTreeElse,r)}},nocache:{process:function(e,r){return this.process(e.subTree,r)}},foreach:{process:function(e,r){var t=this.getActualParamValues(e.params,r),s=t.from;void 0===s&&(s=[]),"object"!=typeof s&&(s=[s]);var a=i(s);r[t.item+"__total"]=a,"name"in t&&(r.smarty.foreach[t.name]={},r.smarty.foreach[t.name].total=a);var n="",p=0;for(var o in s)if(s.hasOwnProperty(o)){if(r.smarty.break)break;r[t.item+"__key"]=isNaN(o)?o:parseInt(o,10),"key"in t&&(r[t.key]=r[t.item+"__key"]),r[t.item]=s[o],r[t.item+"__index"]=parseInt(p,10),r[t.item+"__iteration"]=parseInt(p+1,10),r[t.item+"__first"]=0===p,r[t.item+"__last"]=p===a-1,"name"in t&&(r.smarty.foreach[t.name].index=parseInt(p,10),r.smarty.foreach[t.name].iteration=parseInt(p+1,10),r.smarty.foreach[t.name].first=0===p?1:"",r.smarty.foreach[t.name].last=p===a-1?1:""),++p;var l=this.process(e.subTree,r);void 0!==l&&(r=l.data,n+=l.tpl),r.smarty.continue=!1}return r.smarty.break=!1,r[t.item+"__show"]=p>0,t.name&&(r.smarty.foreach[t.name].show=p>0?1:""),p>0?n:this.process(e.subTreeElse,r)}},call:{process:function(e,r){var t=this.getActualParamValues(e.params,r),s={name:t.__get("name"),params:e.params},a=this.buildInFunctions.function.process.call(this,s,r),i=t.__get("assign",!1);return i?{tpl:"",data:this.assignVar(i,a,r)}:a}},include:{process:function(r,t){var s=this.getActualParamValues(r.params,t),a=s.__get("file",null,0),i=e({},t,s);i.smarty.template=a;var n=this.process(r.subTree,i);return void 0!==n&&(n=n.tpl),s.assign?{tpl:"",data:this.assignVar(s.assign,n,t)}:n}},counter:{process:function(e,r){var t=this.getActualParamValues(e.params,r),s=t.__get("name","default");if(s in r.smarty.counter){var a=r.smarty.counter[s];"start"in t?a.value=parseInt(t.start,10):(a.value=parseInt(a.value,10),a.skip=parseInt(a.skip,10),"down"===a.direction?a.value-=a.skip:a.value+=a.skip),a.skip=t.__get("skip",a.skip),a.direction=t.__get("direction",a.direction),a.assign=t.__get("assign",a.assign),r.smarty.counter[s]=a}else r.smarty.counter[s]={value:parseInt(t.__get("start",1),10),skip:parseInt(t.__get("skip",1),10),direction:t.__get("direction","up"),assign:t.__get("assign",!1)};return r.smarty.counter[s].assign?(r[r.smarty.counter[s].assign]=r.smarty.counter[s].value,{tpl:"",data:r}):t.__get("print",!0)?{tpl:r.smarty.counter[s].value,data:r}:{tpl:"",data:r}}},function:{process:function(r,t){var s=this.runTimePlugins[r.name],a=this.getActualParamValues(s.defaultParams,t);delete a.name;var i=this.getActualParamValues(r.params,t);return this.process(s.tree,e({},t,a,i)).tpl}},while:{process:function(e,r){for(var t="";this.getActualParamValues(e.params,r)[0]&&!r.smarty.break;){var s=this.process(e.subTree,r);void 0!==s&&(r=s.data,t+=s.tpl),r.smarty.continue=!1}return r.smarty.break=!1,{tpl:t,data:r}}}}},o=function(e,r){this.parse(e,r)};return(o.prototype={constructor:o,tree:[],scripts:{},modifiers:{},defaultModifiers:[],defaultModifiersGlobal:[],globalAndDefaultModifiers:[],filters:{variable:[],post:[]},filtersGlobal:{pre:[],variable:[],post:[]},globalAndDefaultFilters:[],buildInFunctions:{},plugins:{},autoLiteral:!0,escapeHtml:!1,debugging:!1,runTimePlugins:{},smarty:{block:{},break:!1,capture:{},continue:!1,counter:{},cycle:{},foreach:{},section:{},now:Math.floor((new Date).getTime()/1e3),const:{},config:{},current_dir:"/",template:"",ldelim:"{",rdelim:"}",version:"3.0.0"},parse:function(e,r){var t;r||(r={}),r.rdelim?this.smarty.rdelim=r.rdelim:o.prototype.right_delimiter&&(this.smarty.rdelim=o.prototype.right_delimiter),r.ldelim?this.smarty.ldelim=r.ldelim:o.prototype.left_delimiter&&(this.smarty.ldelim=o.prototype.left_delimiter),void 0!==r.autoLiteral?this.autoLiteral=r.autoLiteral:void 0!==o.prototype.auto_literal&&(this.autoLiteral=o.prototype.auto_literal),void 0!==r.debugging&&(this.debugging=r.debugging),void 0!==r.escapeHtml?this.escapeHtml=r.escapeHtml:void 0!==o.prototype.escape_html&&(this.escapeHtml=o.prototype.escape_html),e=String(e||""),n.clear(),n.rdelim=this.smarty.rdelim,n.ldelim=this.smarty.ldelim,n.getTemplate=this.getTemplate,n.autoLiteral=this.autoLiteral,n.plugins=this.plugins,n.preFilters=this.filtersGlobal.pre,t=n.getParsed(e),this.tree=t.tree,this.runTimePlugins=t.runTimePlugins},fetch:function(r){var t="";return"object"!=typeof r&&(r={}),r.smarty={},e(r.smarty,this.smarty),this.globalAndDefaultModifiers=o.prototype.defaultModifiersGlobal.concat(this.defaultModifiers),this.globalAndDefaultFilters=o.prototype.filtersGlobal.variable.concat(this.filters.variable),p.clear(),p.plugins=this.plugins,p.modifiers=this.modifiers,p.defaultModifiers=this.defaultModifiers,p.escapeHtml=this.escapeHtml,p.variableFilters=this.globalAndDefaultFilters,p.runTimePlugins=this.runTimePlugins,t=p.getProcessed(this.tree,r,this.smarty),e(this.smarty,t.smarty),this.applyFilters(o.prototype.filtersGlobal.post.concat(this.filters.post),t.output)},applyFilters:function(e,r){for(var t=0;t<e.length;++t)r=e[t](r);return r},registerPlugin:function(e,r,t){"modifier"===e?this.modifiers[r]=t:this.plugins[r]={type:e,process:t}},registerFilter:function(e,r){(this.tree?this.filters:o.prototype.filtersGlobal)["output"===e?"post":e].push(r)},addDefaultModifier:function(e){e instanceof Array||(e=[e]);for(var r=0;r<e.length;++r){var t=n.parseModifiers("|"+e[r],[0]);this.tree?this.defaultModifiers.push(t.tree[0]):this.defaultModifiersGlobal.push(t.tree[0])}},getTemplate:function(e){throw new Error("No template for "+e)},getFile:function(e){throw new Error("No file for "+e)},getJavascript:function(e){throw new Error("No Javascript for "+e)},getConfig:function(e){throw new Error("No config for "+e)}}).registerPlugin("modifier","defaultValue",function(e,r){return r=r||"",e&&"null"!==e&&void 0!==e?e:r}),o.prototype.registerPlugin("modifier","upper",function(e){return String(e).toUpperCase()}),o.prototype.registerPlugin("modifier","lower",function(e){return String(e).toLowerCase()}),o.prototype.registerPlugin("modifier","replace",function(e,r,t){if(!r)return e;e=String(e),r=String(r),t=String(t);var s="",a=-1;for(a=e.indexOf(r);a>=0;a=e.indexOf(r))s+=e.slice(0,a)+t,a+=r.length,e=e.slice(a);return s+e}),o.prototype.registerPlugin("modifier","count_characters",function(e,r){return e=String(e),r?e.length:e.replace(/\s/g,"").length}),o.prototype.registerPlugin("function","__quoted",function(e,r){return e.join("")}),o.prototype.registerPlugin("function","__array",function(e,r){var t=[];for(var s in e)e.hasOwnProperty(s)&&e[s]&&"function"!=typeof e[s]&&(t[s]=e[s]);return t}),o.prototype.registerPlugin("function","__func",function(e,r){var t,s,a=[];for(t=0;t<e.length;++t)a.push(e[t]);if("__owner"in r&&e.name in r.__owner)return s=r.__owner,e.length?s[e.name].apply(s,e):s[e.name].apply(s);if(o.prototype.modifiers.hasOwnProperty(e.name))return(s=o.prototype.modifiers[e.name]).apply(s,a);s=e.name;var i;return"object"==typeof module&&module&&"object"==typeof module.exports?i=global[s]:window&&window.document&&(i=window[s]),console.log(i),r[s]?r[s].apply(r[s],a):i?i.apply(i,a):""}),o});